---
name: 高频问题检查清单
description: 技术骨干在排查问题时的快速检查清单，覆盖 API 路径、环境变量、端口、启动脚本四类高频问题
---

# 高频问题检查清单

排查任何技术问题前，**先逐项检查本清单**，可快速排除 80% 的常见问题，节省深度排查时间。

---

## 第一类：API 路径问题

> 症状：404 Not Found、请求未到达服务、路由不匹配

**检查清单：**
- [ ] API 前缀是否正确？（如 `/api/v1/` vs `/api/`）
- [ ] URL 路径大小写是否一致？（部分服务区分大小写）
- [ ] 路径末尾斜杠是否一致？（`/users` vs `/users/`）
- [ ] 路径参数格式是否匹配？（`:id` vs `{id}` vs `<id>`）
- [ ] 是否有代理层修改了路径？（nginx、gateway 重写规则）
- [ ] 客户端的 baseURL 与服务端监听路径是否一致？
- [ ] HTTP 方法是否匹配？（GET vs POST vs PUT 等）
- [ ] 跨域（CORS）配置是否允许该来源和方法？

**快速验证：**
```bash
# 直接 curl 验证服务端路径
curl -v http://localhost:{PORT}/api/路径

# 查看服务注册的所有路由（不同框架命令不同）
# Express: app._router.stack
# FastAPI: app.routes
# Spring: /actuator/mappings
```

---

## 第二类：环境变量问题

> 症状：服务启动但功能异常、连接失败、配置不生效

**检查清单：**
- [ ] `.env` 文件是否存在？（对比 `.env.example`）
- [ ] 必要的环境变量是否全部设置？
- [ ] 环境变量名称是否完全匹配？（注意大小写和下划线）
- [ ] 值是否有多余的空格或引号？
- [ ] 是否被其他地方的同名变量覆盖？（shell export、docker、CI）
- [ ] 容器环境中是否正确传入了宿主机的变量？
- [ ] 生产/开发/测试环境变量是否混用？

**快速验证：**
```bash
# 打印当前进程看到的环境变量
printenv | grep -i {变量名关键词}

# 检查 .env 文件是否有内容
cat .env | grep -v "^#" | grep -v "^$"

# 确认程序启动时加载了正确的配置
echo $DATABASE_URL
echo $API_KEY
```

---

## 第三类：端口问题

> 症状：连接被拒绝（Connection refused）、端口冲突、无法访问服务

**检查清单：**
- [ ] 服务是否真的已启动并监听目标端口？
- [ ] 端口是否被其他进程占用？
- [ ] 防火墙/安全组是否开放了该端口？
- [ ] 客户端连接的端口与服务监听的端口是否一致？
- [ ] 服务是否监听在 `127.0.0.1`（仅本地）而非 `0.0.0.0`（所有接口）？
- [ ] 容器端口映射是否正确？（如 `-p 8080:3000`）
- [ ] 是否有多个服务竞争同一端口导致随机失败？

**快速验证：**
```bash
# macOS
lsof -i :{PORT}

# Linux
ss -tlnp | grep :{PORT}
# 或
netstat -tlnp | grep :{PORT}

# 测试端口是否可访问
nc -zv localhost {PORT}
telnet localhost {PORT}
```

---

## 第四类：启动脚本问题

> 症状：服务无法启动、启动后立即退出、命令执行卡住

**检查清单：**
- [ ] 启动命令是否在正确的目录下执行？
- [ ] 依赖是否已安装？（`node_modules`、虚拟环境、`go mod`等）
- [ ] 脚本是否有执行权限？（`chmod +x`）
- [ ] 启动命令中是否有交互式输入会阻塞流程？
- [ ] 长时间运行的命令是否需要后台运行？（`&`、`nohup`）
- [ ] 脚本依赖的外部命令是否已安装？
- [ ] 是否有初始化任务需要在启动前完成？（数据库迁移等）
- [ ] 进程退出码是否非零（异常退出）？

**快速验证：**
```bash
# 检查依赖
ls node_modules/ 2>/dev/null || echo "需要 npm install"
python -c "import 依赖名" 2>/dev/null || echo "需要 pip install"

# 后台运行并查看日志
nohup ./start.sh > /tmp/app.log 2>&1 &
sleep 2
cat /tmp/app.log

# 检查脚本语法
bash -n script.sh  # bash 语法检查
node --check app.js  # Node.js 语法检查
python -m py_compile app.py  # Python 语法检查
```

---

## 快速排查决策树

```
问题出现
  │
  ├─ 404 / 路由未找到 ────────────────→ 第一类：API 路径问题
  │
  ├─ 连接被拒绝 (Connection refused) ─→ 第三类：端口问题
  │
  ├─ 服务启动但功能异常 ──────────────→ 第二类：环境变量问题
  │
  ├─ 服务无法启动 / 启动后退出 ───────→ 第四类：启动脚本问题
  │
  └─ 以上都不是 ──────────────────────→ 进入六阶段系统化调试
```

---

## 使用说明

1. **排查前**：优先从本清单快速过一遍，5 分钟内可排除大量常见问题
2. **发现新高频问题**：及时更新本清单（由技术骨干维护）
3. **项目特有问题**：在 `.vibe/docs/经验库.md` 中维护项目内副本
